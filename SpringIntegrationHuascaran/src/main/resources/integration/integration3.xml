<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:int="http://www.springframework.org/schema/integration"
	xmlns:file="http://www.springframework.org/schema/integration/file"
	xmlns:int-sftp="http://www.springframework.org/schema/integration/sftp"
	xmlns:util="http://www.springframework.org/schema/util"
	xsi:schemaLocation="http://www.springframework.org/schema/integration/sftp http://www.springframework.org/schema/integration/sftp/spring-integration-sftp.xsd
		http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util.xsd
		http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
		http://www.springframework.org/schema/integration/file http://www.springframework.org/schema/integration/file/spring-integration-file.xsd
		http://www.springframework.org/schema/integration http://www.springframework.org/schema/integration/spring-integration.xsd">

	<!-- <import resource="sftpConfig.xml" /> -->
	
	<int:channel id="orgigenChannel"></int:channel>
	
	<file:inbound-channel-adapter id="channelAdapter"
		channel="orgigenChannel" directory="${directorio.origen.telefonica.cifrados}"
		filename-pattern="AC*.pgp" >
		<int:poller id="pollerPgp" fixed-rate="5000" error-channel="errorChannel">
		</int:poller>
	</file:inbound-channel-adapter>
	<!-- <int-sftp:inbound-channel-adapter id="sftpInbondAdapter" auto-startup="false" 
		channel="orgigenChannel" session-factory="sftpSessionFactory" remote-directory="si.sftp.sample" 
		delete-remote-files="false" local-directory="file:local-dir" auto-create-local-directory="true" 
		filename-regex=".*\.txt$"> <int:poller id="pollerPgp" fixed-rate="5000"> 
		</int:poller> </int-sftp:inbound-channel-adapter> -->
	
	<int:aggregator input-channel="orgigenChannel" 
		ref="fileHandlingService"
		method="aggregateFiles" 
        output-channel="fileProcessingChannel">
	</int:aggregator>
	
	<file:outbound-channel-adapter id="fileProcessingChannel"
	directory="${directorio.destino.descifrado.consolidado}"
	/>
	
	
	<int:channel id="fileProcessingChannel"></int:channel>
	
	<int:service-activator input-channel="errorChannel" ref="errorHandlingService" method="handleFailed" output-channel="channelAdapter"/>
	
	<!-- 
	<int:channel id="xmlChannel"></int:channel>

	<file:inbound-channel-adapter channel="xmlChannel"
		directory="${directorio.origen.host}"
		filename-pattern="contratos*.xml">
		<int:poller id="pollerXml" fixed-rate="5000">
		</int:poller>
	</file:inbound-channel-adapter>

	<int:service-activator input-channel="xmlChannel"
		ref="reader" method="obtenerContratos" output-channel="destinoChannel" />
	<bean name="reader" class="com.bbva.integration.service.FileHandlingService" />
	<int:channel id="destinoChannel" />
	
	 -->
</beans>
